<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact - KaraCrown LLC</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google reCAPTCHA Script -->
    <script src="https://www.google.com/recaptcha/enterprise.js?render=6LdbcIEqAAAAAF7YusyKPib88RSCFccVZIRqhM9y"></script> <!-- Replace YOUR_SITE_KEY with your actual site key -->
</head>
<body>
    <header>
        <h1>Contact Us</h1>
    </header>
    <nav>
        <a href="index.html">Home</a>
        <a href="rentals.html">Available Rentals</a>
        <a href="contact.html">Contact</a>
    </nav>
    <div class="container">
        <h2>Get in Touch</h2>
        <p>We’d love to hear from you! Reach out with any questions or investment opportunities.</p>
        <form id="contact-form">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required><br><br>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required><br><br>
            <label for="message">Message:</label><br>
            <textarea id="message" name="message" rows="4" required></textarea><br><br>
            <input type="submit" value="Send">
        </form>
        <p id="status-message"></p>
    </div>
    <footer>
        <p>© 2024 KaraCrown LLC. All rights reserved.</p>
    </footer>
    <script>
        // Adding the event listener to the form
        document.getElementById('contact-form').addEventListener('submit', function(event) {
            event.preventDefault();
            console.log("Form submitted, executing reCAPTCHA...");

            // Execute reCAPTCHA and get the token
            grecaptcha.enterprise.ready(async function() {
                console.log("reCAPTCHA is ready, executing...");
                try {
                    const token = await grecaptcha.enterprise.execute('6LdbcIEqAAAAAF7YusyKPib88RSCFccVZIRqhM9y', { action: 'submit' }); // Replace YOUR_SITE_KEY with your actual site key

                    console.log("reCAPTCHA token generated:", token);

                    // Send the token and form data to your backend
                    const response = await fetch('https://karacrown-backend-new.herokuapp.com/verify-recaptcha', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            token: token,
                            name: document.getElementById('name').value,
                            email: document.getElementById('email').value,
                            message: document.getElementById('message').value
                        })
                    });

                    const result = await response.json();
                    console.log("Backend response:", result);

                    if (result.success) {
                        document.getElementById('status-message').innerText = "Your message has been sent successfully!";
                    } else {
                        document.getElementById('status-message').innerText = "Failed to verify reCAPTCHA. Please try again.";
                    }
                } catch (error) {
                    console.error("Error during form submission:", error);
                    document.getElementById('status-message').innerText = "An error occurred. Please try again later.";
                }
            });
        });
    </script>
</body>
</html>
